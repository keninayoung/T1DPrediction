# T1DPrediction

The AI framework utilizes deep learning methods, by combining recurrent neural networks (RNN) that apply bidirectional long short-term memory (LSTM) with multi-layer perceptron (MLP), to evaluate the prediction of persistent islet autoantibodies (islet autoimmunity, IA) and clinical T1D. The AI framework also has the option to use a Transformer and MLP approach for disease prediction. The code was developed with the Visual Studio Community 2022 edition using Python and TensorFlow for the deep learing models. While the AI framework was developed to predict IA/T1D, the parameters can be modified to be used for various diseases/disorders. The AI takes two data files, one temporal and the other static. A column mask_id is the primary key in both files that is used to merge the data. If your datasets contain a different primary key, you can update the code to your primary key value. Also, you may adjust the columns to drop and other elements that were used for this projects specific tasks.

Recent approaches in AI deep learning analyze time-series or sequence data to find patterns, relationships, and predict outcomes that may go unnoticed through conventional statistical approaches. RNNs are a popular deep learning technique for analyzing and predicting outcomes for time-series data as they maintain the memory of inputs, which is ideal for solving problems involving sequential data with temporal dependencies. For this project, we need an AI model capable of learning from time-series and static features. Thus, we developed a bi-directional LSTM concatenated with a multi-layer perceptron (MLP). The LSTM will learn the patterns and relationships of the temporal features, while the MLP will focus on static features of the model. Developing AI models requires proper structuring of training data and hyper tuning parameters to overcome obstacles such as overfitting, where the AI yields importance to spurious correlations and has become too attuned to the training data, resulting in poor predictions on test data or data not seen before. To account for these obstacles and reduce bias, we developed methods to 1) prepare and fit the data for AI utilization; 2) impute, interpolate, and scale the data; 3) create training, validation, and testing datasets; 4) run AI model iterative/random; 5) hyper-tune the AI model to generalize well and achieve high accuracy and low loss on training, validation, and test datasets; and 6) develop packages that harness SHAP and other tools to explain and visualize the output of the AI model and important features. 

To run the application: 

1) Download Visual Studio Community or Professional 2022
2) Save your temporal and static data sets to folder "data" under the project directory. Name the temporal data file "ncc_temporal.txt" and the static file "ncc_static.txt". If you would like to have different file names, you can either pass the file names via the command line or modify the default file names in the T1DPrediction.py file.
3) The current framework does not save the graphs, the code can be adjusted to save the graph outputs, otherwise you will only see them will running the code with breakpoints.
4) The main code is located in the IAPrediction.py file. This AI Framework utilizes object-oriented approaches and packages. Many of the AI modeling and data preparation code exist in the packages included in the project such as aiexplainer, dataprep, deepLearning, imputation, models, and visualizer.
5) The AI uses SHAP to display and list the important features of the model's predictions.
6) The project contains a requirements.txt file for all of the python dependencies.

This project is funded by grant# U24DK097771 from the National Institute of Diabetes, Digestive and Kidney Diseases via the NIDDK Information Network's (dkNET) New Investigator Pilot Program in Bioinformatics.
